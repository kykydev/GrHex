<!DOCTYPE html>
<html lang="fr">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>Grèce anatomie</title>
      <link href="grece.css" type="text/css" rel="stylesheet"></link>
      <script src="https://d3js.org/d3.v7.min.js"></script>
      <script src="carte.js"></script>
      <script src="modèle.js"></script>  <!-- pour le serveur -->
      <script src="joueurs.js"></script>
      <script defer src="troupes.js"></script>
      <script defer src="tourDeJeu.js"></script>
      <script defer src="déplacements.js"></script>
      <script defer src="grece.js"></script>
  </head>
  <body>
      <header><center><label id="titre">Grèce anatomie</label><label id="échelle">(la largeur/hauteur d'un hexagone correspond à 10 kilomètres)</label></center></header>
      <div id ="joueur">
         Votre nom <input id="stratège" type="text" size="12" />
         Région <select id="sélectionRégion"> <option id="optionRégion">Régions</option><option id="optionBéotie">Béotie</option> <option id="optionAttique">Attique</option> <option id="optionArgolide">Argolide</option></select>
         <!-- Num : <label id="numJoueur"></label-->
         <label id="nbJoueurs"> nombre joueurs attendus : 1 </label>
         <!--button type="button" id="btsortie" disabled onClick="quitterLaPartie()">
            Quitter la partie </button-->
         Zoom <input type="number" id="rayonHexagone" onClick="changeRayonHexagone(this)" onChange="changeRayonHexagone(this)" value="20" min="10" max="100" size="3"></input>
         <input type="button" id="numérotation" value="Numérotation"></button>
         <input type="button" id="boutonRègles" value="Règles"></button>
         <input type="button" id="boutonDéplacements" value="Déplacements"></button>
         <input type="button" id="boutonCombats" value="Combats"></button>
         <input type="button" id="boutonBogues" value="Bogues"></button>
      </div>
      <div style="display:flex">
         <div id="carte"></div>
         <div style="width:260px;">
            <br/>
            <center><label class="region" style="color: lightcoral"> Béotie </label></center><br/>
            <div style="display:flex"><div style="width:120px"><label>Stratège</label> <label id="stratègeBéotie" class="stratège"></label></div><div><label id="revenusBéotie">0</label>:<label id="richesseBéotie"></label></div></div>
            <hr/>
            <center><label class="region" style="color: darkred"> Attique </label></center><br/>
            <div style="display:flex"><div style="width:120px"><label>Stratège</label> <label id="stratègeAttique" class="stratège"></label></div><div><label id="revenusAttique">0</label>:<label id="richesseAttique"></label></div></div>
            <hr/>
            <center><label class="region" style="color:green"> Argolide </label></center><br/>
            <div style="display:flex"><div style="width:120px"><label>Stratège</label> <label id="stratègeArgolide" class="stratège"></label></div><div><label id="revenusArgolide">0</label>:<label id="richesseArgolide"></label></div></div>
            <hr/>
            <div><center><label id="labeljour">Jour </label> <label id="numéroJour" style="color: red;"> 0 </label> </center></div>
            <hr/>
            <label id="titrePhase">Phase de jeu : </label> <br/><br/>
            <label id="centrée" class="curseur"> => </label><label> Entrée dans la partie </label> <br/>
            <label id="cvisuDéplacements" class="curseur"> => </label><label>  Visualisation déplacements </label> <br/>
            <label id="ccombats" class="curseur"> => </label><label> Résolution des combats </label> <br/>
            <label id="ccalculRevenus" class="curseur"> => </label><label> Calcul des revenus </label> <br/>
            <label id="cenrôlements" class="curseur"> => </label><label> Enrôlement des hoplites </label> <br/>
            <label id="cdéplacementTroupesLocales" class="curseur"> => </label><label> Dépl. des troupes locales </label><br/>
            <label id="cdéplacementTroupesLointaines" class="curseur"> => </label><label> Dépl. des troupes lointaines </label><br/>
            <label id="cdéplacementStratège" class="curseur"> => </label><label> Déplacement du stratège </label> <br/>
         </div>
         <div style="margin-left: 20px">
            Message <input id="message" type="text" onChange="envoiMessage(this)" maxlength="25"/> <br/>
            <textarea id="messages" rows="15" cols="30"></textarea> <br/><br/>
            <div id="troupesEnMarche">
               <center>
               <label> Troupes en marche :</label><br/>
               <ul id="listeDestinations"></ul>
               </center>
            </div>
            <div id="explicationRevenus">
               <center><button id="finCalculRevenus">Fin de la vision des revenus</button></center>
            </div>
            <div id="explicationEnrôlement">
               <center>
               <label>Cliquez sur deux plaines contiguës<br/>(hexagones jaunes)</label><br/>
               <button id="finEnrôlements">Fin des enrôlements</button>
               </center>
            </div>
            <div id="explicationDéplacementTroupesLocales">
               <center>
               <label id="sélectionHoplite">Sélection des hoplites jaunes<br/>(ceux qui sont avec le stratège)</label>
               <label id="sélectionArrivée">Sélection d'une case d'arrivée<br/>(ou sélection d'un autre hoplite)</label>
               <label id="étatSélection"></label>
               <ul id="déplacementSélectionné"></ul>
               <table><tr><td><button id="annulation" onClick="confirmationDéplacementTroupes(true)">Confirmation</button>
                  </td><td>
               <button id="confirmation" onClick="confirmationDéplacementTroupes(false)">Annulation</button>
               </td></tr></table>
               <button id="finDéplacements">Fin des déplacements</button>
            </center>
            </div>
            <div id="explicationDéplacementStratège">
               <center>
                  <label> Cliquez sur un hexagone ou</label>
                  <button id="finDéplacementStratège">le stratège reste à sa place</button>
               </center>
            </div>
            <div id="explicationCombats">
               <center>
                  <button id="finCombats">Fin de la visualisation des combats</button>
               </center>
            </div>
         </div>
         <!-- Message du serveur : <label id="messageServeur"></label> -->
      </div>
      <div id="tooltip"></div>
      <div id="règles">
         Le but du jeu est soit de contrôler toute la carte (hormis les îles et les régions de Delphes et d'Archaïe),<button onclick="document.getElementById('règles').style.visibility='hidden'" style="float:right;"> X </button><br/>soit au jour J (réglé par défaut à 181, un tour de jeu correspondant à un jour) d'avoir potentiellement les plus forts revenus. <br/><br/>
         Lancement de la partie : les joueurs saisissent le nom du stratège et choisissent une région parmi celle(s) encore disponible(s)<br/>La partie est lancée quand le nombre de joueurs (qui a été défini par le premier joueur) est atteint. <br/>Le stratège est placé au début de la partie sur la cité principale de sa région. <br/><br/>
         Les phases de jeu :
         <ul>
            <li>Visualisation des déplacements de ses propres troupes planifiés précédemment (celles des troupes adverses restant masquées)</li>
            <li>Résolution des combats provoqués par les déplacements (toutes les troupes apparaissent dans une distorsion temporelle)
            </li>
            <li>Calcul des revenus journaliers et tous les premiers jours du mois de la richesse</li>
            <li>Enrôlement d'hoplites (sélection de deux hexagones contigüs de plaines : position sur le dernier hexagone ; coût 2 UR)</li>
            <li>Déplacement des troupes qui se situent à l'endroit où se trouve le stratège</li>
            <li>Envoi de messagers aux troupes lointaines (pour l'instant non implémenté)</li>
            <li>Déplacement du stratège</li>
         </ul>
         Les revenus en unités de ressources (UR) sont calculés chaque jour<br/>
         Au 181ième jour, ils définissent le vainqueur. Le revenu journalier est fonction des montants suivants :
         <ul>
            <li> Les cités principales rapportent 7 UR, les cités annexes 3 et les ports 4 (en sachant que deux cités sont aussi des ports)</li>
            <li> Au début : Béotie 10 (Thèbes 7, Coronée 3), Attique 11 (Athènes 7, Le Pirée 4), Argolide 18 ( Corinthe 11, Mégare 7)
            </li>
            <li>Les hexagones contrôlés en plaine (à condition que les hommes n'aient pas été enrôlés) produisent 1 UR</li>
            <li>L'entretien des unités d'hoplites et de l'unité de cavalerie du stratège coûtent 1 UR par unité</li>
         </ul>
         Les troupes : au début de partie, chaque région possède 5 unités d'hoplites (fantassins) répartis sur deux cités/ports
         <ul>
            <li>Déplacements de celles qui accompagnent le stratège : sélection d'une troupe, sélection d'une destination, confirmation</li>
            <li><i>Déplacements des lointaines : sélection d'un messager, ordre de marche (sélection troupe et destination), confirmation</i></li>
         </ul>
      </div>
      <div id="explicationsDéplacements">
         Déplacement des hoplites :<button onclick="document.getElementById('explicationsDéplacements').style.visibility='hidden'" style="float:right;"> X </button><br/>
         Les hoplites se déplacent en un jour de deux hexagones en plaine, d'un seul hexagone en montagne :
         <ul>
         <li> il reste une plaine ou une montagne à franchir : un jour </li>
         <li> il reste une plaine suivie d'une autre plaine ou d'une montagne : un jour </li>
         <li> une plaine a été franchie et il reste une montagne et une plaine : deux jours </li>
         <li> une plaine a été franchie et il reste deux montagnes : deux jours </li>
         </ul>
         <hr/>
         Déplacement en un jour du stratège qui est à la tête d'une unité de cavalerie :
         <ul>
            <li> trois ou quatre plaines </li>
            <li> deux plaines et une montagne </li>
            <li> deux montagnes </li>
         </ul>
         <hr/>
         Si des hoplites d'une même région sont les seuls à occuper un hexagone, cet hexagone appartient alors à cette région.<br/>
         Ce n'est pas le cas de l'unité de cavalerie qui accompagne le stratège.<br/>
      </div>
      <div id="explicationsCombats">
         Dès que des troupes de régions différentes se trouvent sur le même hexagone, le combat est engagé.
         <button onclick="document.getElementById('explicationsCombats').style.visibility='hidden'" style="float:right;"> X </button><br/>
         Les unités d'hoplites et celle de cavalerie qui accompagne le stratège ont une valeur de 1. <br/>
         Les premières troupes qui se trouvent sur une hauteur ou dans une ville ont une force double.
         <hr/>
         En cas de triple occupation d'un hexagone, il n'y a pas de coalition :
         <ul>
            <li> les deux premières troupes se battent entre elles </li>
            <li> puis c'est au tour de la troupe restée victorieuse de se confronter à la troisième </li>
         </ul>
      </div>
      <div id="explicationsBogues">
         Liste des limitations ou des bogues recensés : <button onclick="document.getElementById('explicationsBogues').style.visibility='hidden'" style="float:right;"> X </button><br/>
         <ul>
            <li> <font color='red'>Limite de 5 unités d'hoplites par hexagone</font></li>
            <li> La zone de déplacement du stratège est raccourcie d'un hexagone </li>
            <li> Les déplacements suivant les types d'hexagones sont suspects (à vérifier)</li>
         </ul>
         <hr/>
         Contraintes sur les manipulations graphiques :<br/>
         Quand il y a plus de 5 unités d'hoplites par hexagones, des marqueurs (les cercles) sont superposés.<br/>
         Le marqueur le plus haut indique par un chiffre le nombre de marqueurs superposés. Sa sélection entraîne également ceux-ci.<br/>
      </div>
  </body>
</html>